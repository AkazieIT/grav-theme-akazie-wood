{% extends 'partials/base.html.twig' %}
{% import 'partials/cascade-filters.html.twig' as f %}
{% set queries = uri.query(null, true) %}
{% if queries is empty %}
    {% set collection = page.collection %}
{% else %}
    {% set collection = taxonomy.findTaxonomy(queries) %}
{% endif %}

{% block content %}
<div class="sidebar column is-narrow">
	{% set taxlist = cascadeFilters.get() %} {# get texonomy list #}
	{% set queries = uri.query(null, true) %} {# get queries as Array #}
	<a href="{{ page.url }}" class="button">Clean all filters </a>
	{% if taxlist %}
		{% for key, values in taxlist %}
			<p>
				{{ key }}
			</p>
			<ul class="is-clearfix">
				{% for tax in values|keys %}
					<li style="float: left; margin: 5px">
						{{ f.genQueryUrl(queries|sort,key,tax, page.url, cascadeFilters) }}
					</li>
				{% endfor %}
			</ul>
		{% endfor %}
	{% endif %}
</div>


  <section class="page section-default">
    <div class="row">
      <article class="modular section-text col-12">
        {% if page.header.showtitle == 1 %}<h2 class="heading">{{ page.header.title }}</h2>{% endif %}
        <div class="markdown {% if page.header.showtitle == 2 %}title-placeholder{% endif %}">
          {{ page.content|raw }}
        </div>

      </article>
    </div>
    {% for child in collection %}
          {% include 'partials/cat_item.html.twig' with {'blog':page, 'page':child, 'truncate':true} %}
      {% endfor %}
  </section>
{% endblock %}
